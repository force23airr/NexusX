# ═══════════════════════════════════════════════════════════════
# NexusX — Environment Configuration
# .env.example
#
# Copy to .env and fill in your values:
#   cp .env.example .env
# ═══════════════════════════════════════════════════════════════

# ─── General ───
NODE_ENV=development

# ─── Database (PostgreSQL 16) ───
DATABASE_URL=postgresql://nexusx:nexusx_local@localhost:5432/nexusx_dev

# ─── Redis ───
REDIS_URL=redis://localhost:6379

# ─── Service Ports ───
GATEWAY_PORT=3100
AUCTION_PORT=3200
ROUTER_PORT=3300
WEB_PORT=3000

# ─── Platform Configuration ───
PLATFORM_FEE_RATE=0.12           # 12% transaction fee
SANDBOX_ENABLED=true             # Enable sandbox mode (no billing)
SETTLEMENT_BATCH_SIZE=50         # Max transactions per settlement batch
GAS_PRICE_CEILING_GWEI=5         # Max gas price for on-chain settlement

# ─── AI Router ───
CLASSIFIER_MODE=rule_based       # "rule_based" or "llm"
# ANTHROPIC_API_KEY=sk-ant-...   # Required if CLASSIFIER_MODE=llm

# ─── Semantic Search (Vector Embeddings) ───
# OPENAI_API_KEY=sk-...          # Enables semantic vector search (optional, falls back to keywords)

# ─── Settlement (Base L2) ───
# BASE_RPC_URL=https://sepolia.base.org
# DEPLOYER_PRIVATE_KEY=0x...
# SETTLEMENT_CONTRACT_ADDRESS=0x...
# USDC_CONTRACT_ADDRESS=0x036CbD53842c5426634e7929541eC2318f3dCF7e  # Base Sepolia
# BASESCAN_API_KEY=...

# ─── Web Frontend ───
NEXT_PUBLIC_API_URL=http://localhost:3100

# ─── Auth (JWT) ───
# JWT_SECRET=your-256-bit-secret
# JWT_EXPIRY=24h

# ─── x402 Payment Protocol ───
X402_ENABLED=true
X402_FACILITATOR_URL=https://x402.org/facilitator
X402_PLATFORM_ADDRESS=0x...  # Platform wallet that receives x402 payments (required)
# CDP_API_KEY_ID=...         # Required for mainnet facilitator
# CDP_API_KEY_SECRET=...     # Required for mainnet facilitator
X402_NETWORK=eip155:84532    # Base Sepolia for dev, eip155:8453 for mainnet

# ─── MCP Server (AI Agent Tool Integration) ───
NEXUSX_TRANSPORT=stdio               # "stdio" for local agents, "http" for remote
MCP_PORT=3400                        # HTTP transport port (only for http mode)
# NEXUSX_API_KEY=nxs_...             # Agent's NexusX API key (optional when CDP wallet is configured)
NEXUSX_GATEWAY_URL=http://localhost:3100
NEXUSX_REGISTRY_REFRESH_MS=60000     # How often to refresh tool list from DB
NEXUSX_SESSION_BUDGET_USDC=0         # Per-session spending limit (0=unlimited, kept for spend visibility)
NEXUSX_SANDBOX=false                 # Enable sandbox mode (no billing)

# ─── CDP Server Wallet (x402 On-Chain Payments) ───
# When configured, the MCP executor pays for API calls via x402 USDC payments
# on Base instead of API key auth. Fund the wallet address shown at startup.
#
# ─ Option A: Local EOA (simpler — use any Ethereum private key) ─
# CDP_WALLET_PRIVATE_KEY=0x...          # hex-encoded private key (fund with USDC on Base)
# CDP_NETWORK_ID=base-mainnet           # or base-sepolia for testnet
#
# ─ Option B: CDP Platform (production — keys managed by Coinbase HSM) ─
# CDP_API_KEY_NAME=organizations/abc.../apiKeys/...
# CDP_API_KEY_PRIVATE_KEY="-----BEGIN EC PRIVATE KEY-----\n...\n-----END EC PRIVATE KEY-----\n"
# CDP_NETWORK_ID=base-mainnet
# CDP_WALLET_DATA_FILE=.cdp-wallet.json # local wallet seed file (gitignored, mode 0600)

# ─── Coinbase Onramp ───
# NEXT_PUBLIC_COINBASE_ONRAMP_APP_ID=...

# ─── Coinbase (Embedded Wallets) ───
# COINBASE_API_KEY=...
# COINBASE_API_SECRET=...
